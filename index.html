<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>PO → Offline Excel (URL Images, Correct Sizing)</title>
<style>
  :root { --pad:14px; --grid:#ddd; --ink:#111; --muted:#666; }
  *{box-sizing:border-box;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif}
  body{margin:0;background:#f6f7f8;color:var(--ink)}
  .wrap{max-width:1100px;margin:0 auto;padding:var(--pad);display:grid;gap:var(--pad)}
  .bar{display:flex;gap:8px;flex-wrap:wrap;align-items:center}
  button{padding:8px 12px;border:1px solid var(--ink);background:var(--ink);color:#fff;border-radius:8px;cursor:pointer}
  .card{background:#fff;border:1px solid var(--grid);border-radius:10px;overflow:hidden}
  .card h2{margin:0;padding:10px 12px;border-bottom:1px solid var(--grid);background:#fafafa}
  .card .inner{padding:12px}

  .a4{background:#fff;border:1px solid var(--grid);border-radius:8px;padding:12mm}

  .letterhead{display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:12px}
  .logo{height:48px;display:flex;align-items:center;gap:10px}
  .logo img{height:48px;width:auto;display:block}
  .company h1{font-size:18px;line-height:1.1;margin:0}
  .company .sub{font-size:12px;color:var(--muted)}
  .doc-title{text-align:right}
  .doc-title h2{margin:0;font-size:22px}
  .doc-title .code{font-size:12px;color:var(--muted)}

  .info{display:grid;grid-template-columns:160px 1fr 160px 1fr;gap:6px 10px;margin:8px 0 12px}
  .info .k{color:#444}
  .info .v{font-weight:600}

  .remarks{border:1px dashed #bbb;border-radius:8px;padding:10px;margin:8px 0 14px;background:#fcfcfc}
  .remarks h3{margin:0 0 6px 0;font-size:14px}
  .remarks p{margin:0;font-size:13px;color:#333}

  table{width:100%;border-collapse:collapse;table-layout:fixed}
  th,td{border:1px solid #000;padding:4px 6px;vertical-align:top}
  th{background:#e9ecef;text-align:center}
  .right{text-align:right}
  .center{text-align:center}
  .imgbox{width:120px;height:120px;display:flex;align-items:center;justify-content:center}
  .imgbox img{max-width:100%;max-height:100%;display:block}

  .footer{display:flex;justify-content:space-between;align-items:center;gap:12px;margin-top:12px}
  .footnote{font-size:12px;color:#555}
  .footlogo img{height:32px;width:auto;display:block}

  .note{font-size:12px;color:#555}
</style>
</head>
<body>
  <div class="wrap">
    <div class="bar">
       <span id="status" class="note"></span>
     </div>

    <div class="card">
      <h2>Purchase Order – URL Images Demo</h2>
      <div class="inner">
        <div class="a4">
          <!-- Letterhead -->
          <div class="letterhead">
            <div class="logo">
              <img alt="Company Logo" crossorigin="anonymous"
                   src="https://picsum.photos/seed/logo1/320/96">
              <div class="company">
                <h1>Acme Metals Pte Ltd</h1>
                <div class="sub">UEN: 201912345Z · 123 Pioneer Ave, Singapore · +65 6123 4567</div>
              </div>
            </div>
            <div class="doc-title">
              <h2>PURCHASE ORDER</h2>
              <div class="code">Form: PO-STD-001</div>
            </div>
          </div>

          <!-- Document Info -->
          <div class="info">
            <div class="k">PO No.</div><div class="v">PO-2025-000123</div>
            <div class="k">Date</div><div class="v">2025-09-29</div>
            <div class="k">Supplier</div><div class="v">Steel & Co. Sdn Bhd</div>
            <div class="k">Ship To</div><div class="v">Acme Warehouse, Jurong</div>
            <div class="k">Currency</div><div class="v">SGD</div>
            <div class="k">Buyer</div><div class="v">Wei Jun</div>
          </div>

          <!-- Remarks -->
          <div class="remarks">
            <h3>Remarks</h3>
            <p>Deliver within 7 working days. Include mill test certificate. Packaging: palletized & shrink-wrapped.</p>
          </div>

          <!-- Items Table (URL images) -->
          <table id="poTable">
            <colgroup>
              <col style="width:50px">
              <col style="width:140px">
              <col style="width:360px">
              <col style="width:120px">
              <col style="width:120px">
              <col style="width:140px">
            </colgroup>
            <thead>
              <tr>
                <th>#</th>
                <th>Image</th>
                <th>Description</th>
                <th class="right">Qty</th>
                <th class="right">Unit Price</th>
                <th class="right">Subtotal</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="center">1</td>
                <td class="center">
                  <div class="imgbox">
                    <img alt="Item A" crossorigin="anonymous"
                         src="https://picsum.photos/id/1015/600/400">
                  </div>
                </td>
                <td>Stainless Steel Flat Bar 0.5mm × 4B 304 (Cold Drawn)</td>
                <td class="right">10</td>
                <td class="right">25.00</td>
                <td class="right">250.00</td>
              </tr>
              <tr>
                <td class="center">2</td>
                <td class="center">
                  <div class="imgbox">
                    <img alt="Item B" crossorigin="anonymous"
                         src="https://picsum.photos/id/1025/600/400">
                  </div>
                </td>
                <td>Carbon Steel Sheet HR 6mm × 4' × 8'</td>
                <td class="right">3</td>
                <td class="right">120.00</td>
                <td class="right">360.00</td>
              </tr>
              <tr>
                <td class="center">3</td>
                <td class="center">
                  <div class="imgbox">
                    <img alt="Item C" crossorigin="anonymous"
                         src="https://picsum.photos/id/1035/600/400">
                  </div>
                </td>
                <td>Aluminium Angle 20×20×2mm, Anodized Matte</td>
                <td class="right">5</td>
                <td class="right">18.50</td>
                <td class="right">92.50</td>
              </tr>
            </tbody>
            <tfoot>
              <tr>
                <td colspan="5" class="right"><strong>Total</strong></td>
                <td class="right"><strong>702.50</strong></td>
              </tr>
            </tfoot>
          </table>

          <!-- Footer -->
          <div class="footer">
            <div class="footnote">
              Prepared by: Purchasing Dept · Terms: 30 days · Thank you for your business.
            </div>
            <div class="footlogo">
              <img alt="Footer Logo" crossorigin="anonymous"
                   src="https://picsum.photos/seed/logo2/256/64">
            </div>
          </div>

          <p class="note" style="margin-top:8px">
            Note: To embed URL images into Excel offline, the image hosts must allow CORS
            (<code>Access-Control-Allow-Origin: *</code>) or be same-origin.
          </p>
        </div>
      </div>
    </div>
  </div>

  <!-- ExcelJS bundled for offline use -->
       <button id="exportBtn">Export Full Page to Excel (.xlsx)</button>
  <script src="./vendor/exceljs.min.js"></script>
  <script type="module" src="./src/exporter.js"></script>
</body>
</html>
